{% extends 'dashboard/base_dashboard.html' %}
{% load static %}


{% block title %}
    Catégorie | Q&A | {{ block.super }}
{% endblock title %}

{% block stylesheets %}

    {{ block.super }}

    <link href="{% static 'dashboard/css/plugins/summernote/summernote-bs4.css' %}" rel="stylesheet">


{% endblock stylesheets %}


{% block content %}

    <div class="wrapper wrapper-content  animated fadeInRight" style="width:100%">


        <div class="row">
            <div class="col-lg-12">

                <div class=" float-left">
                    <a href="{% url 'dashboard:qa_categories' %}">
                        <button class="btn btn-primary dim"><i class="fa fa-arrow-left"></i> Liste de catégories
                        </button>
                    </a>

                </div>

                <div class=" float-right">
                    <a href="{% url 'dashboard:qa_delete_category' id_category=category.id %}">
                        <button id="btn_lancer_compagne" class="btn btn-danger dim">
                            <i class="fa fa-trash"></i> Supprimer
                        </button>
                    </a>

                    <a href="{% url 'dashboard:qa_update_category' id_category=category.id %}">
                        <button class="btn btn-success dim"><i class="fa fa-pencil"></i> Modifier</button>
                    </a>

                </div>


            </div>

        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="text-center">
                    <h3 style="    text-transform: uppercase;">{{ category.title }} : {{ category.question_set.all.count }} Questions</h3>
                </div>

            </div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-11" style="margin:auto;">


                <div class="social-feed-box">

                    <div class="social-avatar">
                        {% for question in category.question_set.all %}
                            <div class="row">

                                <div class="col-md-10">
                                    <div class="media-body">

                                        <h3>
                                            <a href="{% url 'dashboard:qa_question' id_question=question.id %}">{{ question.title }}</a>
                                        </h3>
                                        <p class="badge badge-primary"> #{{ question.category.title }}</p>
                                    </div>


                                    <p>
                                        {% for tag in question.tags.all %}
                                            <span class="badge badge-dark">{{ tag.title }}</span>
                                        {% endfor %}
                                    </p>
                                    <i class="fa fa-clock-o"></i> {{ question.creation_date }} &nbsp;&nbsp;&nbsp;
                                    <i class="fa fa-eye"></i> {{ question.views_number }} &nbsp;&nbsp;&nbsp;
                                    <i class="fa fa-commenting-o"></i> {{ question.answer_set.all.count }}&nbsp;&nbsp;&nbsp;
                                </div>

                                <div class="col-md-2" style="text-align: center;">

                                <span href="" class="">
                                    <img style="height:100px; width:100px;" alt="image"
                                         src="{% if question.user.photo_profil.image %} {{ question.user.photo_profil.image.url }}  {% else %} {% static 'dashboard/img/default_profil_m.png' %} {% endif %}">
                                </span>
                                    <br>
                                    <span>
                                    <a href=""> {{ question.user.user.first_name | title }} {{ question.user.user.last_name | title }} </a>
                                </span>
                                    <br>
                                    <span>
                                    <i class="fa fa-commenting-o"></i> {{ question.user.answer_set.all.count }}
                                    &nbsp;&nbsp;&nbsp;
                                    <i class="fa fa-trophy"></i> {{ question.user.points }}
                                </span>
                                </div>


                            </div>


                            {% if not forloop.last %}
                                <hr>
                            {% endif %}

                        {% endfor %}


                    </div>


                </div>


            </div>

        <div class="col-md-11 mar-b-30" style="margin:auto;">
                <div class="list-group">

                    <a href="{% url 'dashboard:tracking_visites' %}?url={{ category.tracking_get_absolute_url }}"
                       class="list-group-item list-group-item-action active disabled">
                        Derniers visites <span class="pull-right">Voir tout</span>
                    </a>

                    <table class="table table-striped table-bordered">
                        <thead>
                        <th>Utilisateur</th>
                        <th>Date</th>
                        </thead>

                        <tbody>
                        {% for tracking in tracking_dernieres_visites %}
                            <tr>
                                <td>{% if not tracking.user %} Visiteur non connecté {% else %}
                                    <a href="{% url 'dashboard:user_infos' id_user=tracking.user.profil.id %}">{{ tracking.user.first_name|title }} {{ tracking.user.last_name|title }}</a>{% endif %}
                                </td>
                                <td>{{ tracking.timestamp }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td valign="top" colspan="2" class="dataTables_empty text-center">Aucun élément à
                                    afficher
                                </td>
                            </tr>
                        {% endfor %}

                        </tbody>

                    </table>
                </div>
            </div>



        </div>
    </div>




{% endblock content %}

{% block scripts %}

    {{ block.super }}
    <script>
        $('#dashboard_qa').addClass("active");
    </script>





{% endblock scripts %}

