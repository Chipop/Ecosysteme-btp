{% extends 'dashboard/base_dashboard.html' %}
{% load static %}

{% block title %}
    Produit | Ecommerce | {{ block.super }}
{% endblock title %}

{% block stylesheets %}
    {{ block.super }}


{% endblock stylesheets %}

{% block content %}

    <div class="wrapper wrapper-content wrapper-content-custom">

        <div class="row">
            <div class="col-lg-12">

                <div class=" float-left">
                    <a href="{% url 'dashboard:marketplace_products' %}">
                        <button id="btn_lancer_compagne" class="btn btn-primary dim">
                            <i class="fa fa-arrow-left"></i> Liste des produits
                        </button>
                    </a>
                </div>

                <div class=" float-right">
                    <a href="{% url 'dashboard:delete_product' id_product=produit.id %}">
                        <button id="btn_lancer_compagne" class="btn btn-danger dim">
                            <i class="fa fa-trash"></i> Supprimer
                        </button>
                    </a>

                    <a href="{% url 'dashboard:update_product' id_product=produit.id %}">
                        <button class="btn btn-success dim"><i class="fa fa-pencil"></i> Modifier</button>
                    </a>

                </div>
            </div>

        </div>

        <div class="row">
            <div class="col-lg-12">

                <div class="ibox product-detail">
                    <div class="ibox-content">

                        <div class="row">
                            <div class="col-md-5">


                                <div id="demo" class="carousel slide" data-ride="carousel">

                                    <!-- Indicators -->
                                    <ul class="carousel-indicators">
                                        <li data-target="#demo" data-slide-to="0" class="active"></li>

                                        {% if produit.commerceimage_set.all.exists %}
                                            {% for image in produit.commerceimage_set.all %}
                                                <li data-target="#demo" data-slide-to="{{ forloop.counter }}"></li>
                                            {% endfor %}
                                        {% endif %}
                                    </ul>

                                    <!-- The slideshow -->
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="{% if produit.image %} {{ produit.image.url }} {% else %} {% static 'dashboard/img/interrogation.jpg' %} {% endif %}"
                                                 alt="Los Angeles"
                                                 style="height:100%;width:100%;">
                                        </div>

                                        {% if produit.commerceimage_set.exists %}
                                            {% for image in produit.commerceimage_set.all %}
                                                <div class="carousel-item">
                                                    <img src="{% if image.image %} {{ image.image.url }} {% else %} {% static 'dashboard/img/interrogation.jpg' %} {% endif %}"
                                                         alt="Los Angeles"
                                                         style="height:100%;width:100%;">
                                                </div>
                                            {% endfor %}
                                        {% endif %}


                                    </div>

                                    <!-- Left and right controls -->
                                    <a class="carousel-control-prev" href="#demo" data-slide="prev">
                                        <span class="carousel-control-prev-icon"></span>
                                    </a>
                                    <a class="carousel-control-next" href="#demo" data-slide="next">
                                        <span class="carousel-control-next-icon"></span>
                                    </a>

                                </div>

                                <dl class="small m-t-md">

                                    <dt>Catégorie</dt>
                                    <dd>{{ produit.cat.name }}</dd>

                                    <dt>Marque</dt>
                                    <dd>{{ produit.brand.name }}</dd>

                                    {% for detail in produit.commerceinformation_set.all %}
                                        <dt>{{ detail.name }}</dt>
                                        <dd>{{ detail.value }}</dd>
                                    {% endfor %}

                                    <dt>Tags</dt>
                                    <dd>
                                        {% for tag in produit.tags.all %}
                                            {{ tag.name }}{% if forloop.last %}.
                                            {% else %},
                                            {% endif %}
                                        {% endfor %}
                                    </dd>
                                </dl>

                            </div>
                            <div class="col-md-7">

                                <h2 class="font-bold m-b-xs">
                                    {{ produit.name }}
                                </h2>
                                <small>Code Produit : #{{ produit.id }}</small>
                                |
                                <small>Exposant : <a
                                        href="{% url 'dashboard:marketplace_shop' id_shop=produit.supplier.id %}">{{ produit.supplier.name }}</a>
                                </small>
                                <div class="m-t-md">
                                    <h2 class="product-main-price">{% if produit.price_from %} à partir
                                        de {% endif %}{{ produit.price }} DH / {{ produit.unit }}
                                    </h2>
                                </div>

                                <div class="m-t-md">
                                    <h5 class="product-main-price">
                                        En stock <i class="fa fa-{% if stock_nb == 0 %}times{% else %}check{% endif %}"
                                                    style="color:#1ab394;"></i>
                                        Vendu <span class="badge badge-primary">{{ vendu_nb }}</span>
                                        Disponible <span class="badge badge-primary">{{ stock_nb }}</span>
                                        Achat minimum <span
                                            class="badge badge-primary">{{ produit.quantity_min }}</span>
                                    </h5>
                                </div>
                                <hr>

                                <h4>Description</h4>

                                <div class="small text-muted">
                                    {% if produit.description %}
                                        {{ produit.description | safe }}
                                    {% else %}
                                        -
                                    {% endif %}


                                </div>

                                <hr>


                            </div>
                        </div>

                    </div>
                </div>

            </div>


        </div>

        <div class="row">
            <div class="col-md-12 mar-b-30">
                <div class="list-group">
                    <a href="{% url 'dashboard:tracking_visites' %}?url={{ produit.tracking_get_absolute_url }}"
                       class="list-group-item list-group-item-action active disabled">
                        Derniers visites <span class="pull-right">Voir tout</span>
                    </a>

                    <table class="table table-striped table-bordered">
                        <thead>
                        <th>Utilisateur</th>
                        <th>Date</th>
                        </thead>

                        <tbody>
                        {% for tracking in tracking_dernieres_visites %}
                            <tr>
                                <td>{% if not tracking.user %} Visiteur non connecté {% else %}
                                    <a href="{% url 'dashboard:user_infos' id_user=tracking.user.profil.id %}">{{ tracking.user.first_name|title }} {{ tracking.user.last_name|title }}</a>{% endif %}
                                </td>
                                <td>{{ tracking.timestamp }}</td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td valign="top" colspan="2" class="dataTables_empty text-center">Aucun élément à
                                    afficher
                                </td>
                            </tr>
                        {% endfor %}

                        </tbody>

                    </table>
                </div>
            </div>
        </div>


    </div>







{% endblock content %}




{% block scripts %}

    {{ block.super }}





    <script>
        $('#dashboard_marketplace').addClass("active");
        $('#marketplace_products').addClass("active");

    </script>





{% endblock scripts %}