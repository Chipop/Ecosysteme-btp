{% extends 'dashboard/base_dashboard.html' %}
{% load static %}
{% load humanize %}

{% block title %}
    Commande | Ecommerce | {{ block.super }}
{% endblock title %}


{% block stylesheets %}
    {{ block.super }}
{% endblock stylesheets %}

{% block content %}

    <div class="wrapper wrapper-content wrapper-content-custom">


        <div class="row">

            <div class="col-lg-12">

                <div class=" float-left">
                    <a href="{% url 'dashboard:marketplace_orders' %}">
                        <button id="btn_lancer_compagne" class="btn btn-primary dim">
                            <i class="fa fa-arrow-left"></i> Liste des commandes
                        </button>
                    </a>
                </div>

                <div class=" float-right">
                    <a href="">
                        <button id="btn_lancer_compagne" class="btn btn-danger dim">
                            <i class="fa fa-trash"></i> Supprimer
                        </button>
                    </a>


                </div>
            </div>


            <div class="col-lg-8">
                <div class="ibox ">
                    <div class="ibox-title">
                        <h5>Détails de la commande #{{ order.id }}

                            {% if order.status == "Shipped" %}
                                <span class="badge badge-primary">{{ order.status }}</span>
                            {% elif order.status == "Processing" %}
                                <span class="badge badge-warning">{{ order.status }}</span>
                            {% elif order.status == "Created" %}
                                <span class="badge badge-success">{{ order.status }}</span>
                            {% endif %}

                            <span class="badge badge-white">{{ order.payment_method }}</span></h5>
                    </div>
                    <div class="ibox-content">
                        <table class="table">
                            {% for orderline in order.orderline_set.all %}
                                <tr>
                                    <td>
                                        <div class="row">
                                            <div class="col-lg-3">
                                                <img src="{% if orderline.product.image %} {{ orderline.product.image.url }} {% else %} {% static 'dashboard/img/interrogation.jpg' %} {% endif %}"
                                                     alt="" height="50"
                                                     width="50">
                                            </div>
                                            <div class="col-lg-9">
                                                <h4>
                                                    <a href="{% url 'dashboard:marketplace_product' id_product=orderline.product.id %}">{{ orderline.product.name }}</a>
                                                </h4>
                                                <h4>{{ orderline.product.brand.name }}</h4>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="product_details_price"><br>{{ orderline.product.price | intcomma }} DH
                                    </td>
                                    <td class="product_details_price"><br>×</td>
                                    <td class="product_details_price"><br>{{ orderline.quantity }}</td>
                                    <td class="product_details_price"><br>{{ orderline.total | intcomma }} DH</td>
                                </tr>
                            {% endfor %}
                            <!-- tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="product_details_price"><br>Sous Total</td>
                                <td class="product_details_price"><br>160 DH</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="product_details_price"><br>Free Shiping</td>
                                <td class="product_details_price"><br>0 DH</td>
                            </tr>

                            <tr -->

                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="product_details_price"><br>Total</td>
                                <td class="product_details_price"><br>{{ order.amount | intcomma }} DH</td>
                            </tr>


                        </table>
                    </div>
                </div>

                <div class="ibox ">
                    <div class="ibox-title">
                        <h5>Autres informations sur la commande</h5>
                    </div>
                    <div class="ibox-content">
                        <div class="row">
                            <div class="col-lg-6">
                                <span style="font-weight:600;">Créee le</span><br><br>{{ order.date }}
                            </div>
                            <div class="col-lg-6">
                                <span style="font-weight:600;">Complète le</span><br><br>{% if order.date_complete %}
                                {{ order.date_complete }} {% else %} -  {% endif %}
                            </div>
                        </div>

                        <br><br>

                        <div class="row">
                            <div class="col-lg-6">
                                <span style="font-weight:600;">Méthode de paiement</span><br><br>{{ order.payment_method }}
                            </div>
                            <div class="col-lg-6">
                                <span style="font-weight:600;">Méthode de livraison</span><br><br> {{ order.delivery_method }}
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="col-lg-4">
                <div class="ibox ">
                    <div class="ibox-title">
                        <h5>Client </h5>
                    </div>
                    <div class="ibox-content">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <img src="{% if order.user.photo_profil.image %} {{ order.user.photo_profil.image.url }} {% else %} {% static 'dashboard/img/default_profil_m.png' %} {% endif %}"
                                             alt=""
                                             style="height: 80px;border-radius:50%;">
                                    </div>
                                    <div class="col-lg-12">
                                        <a href="{% url 'dashboard:user_infos' id_user=order.user.id %}">{{ order.user.user.first_name | title }} {{ order.user.user.last_name | title }}</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="pull-right">
                                    <a href="">{{ order.user.order_set.all.count }} Commandes</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="ibox-content">
                        <h5>Contact</h5>
                        <p>{{ order.user.user.email | title }}</p>
                    </div>

                    <div class="ibox-content">
                        <h5>Adresse de facturation</h5>
                        <p>
                            {{ order.user.user.last_name | title }} {{ order.user.user.first_name | title }}
                            {% if order.user.billingaddress.company %}
                                <br>{{ order.user.billingaddress.company }}
                            {% endif %}
                            <br>{{ order.user.billingaddress.address }} {{ order.user.billingaddress.city }}
                            {{ order.user.billingaddress.region }}, {{ order.user.billingaddress.country }}
                        </p>
                    </div>

                    <div class="ibox-content">
                        <h5>Adresse de livraison</h5>
                        <p>
                            {{ order.user.user.last_name | title }} {{ order.user.user.first_name | title }}
                            {% if order.user.shippingaddress.company %}
                                <br>{{ order.user.shippingaddress.company }}
                            {% endif %}
                            <br>{{ order.user.shippingaddress.address }} {{ order.user.shippingaddress.city }}
                            {{ order.user.shippingaddress.region }}, {{ order.user.shippingaddress.country }}
                        </p>
                    </div>

                </div>
            </div>


        </div>


    </div>




    </div>




{% endblock content %}




{% block scripts %}

    {{ block.super }}











    <script>
        $('#dashboard_marketplace').addClass("active");
        $('#marketplace_orders').addClass("active");

    </script>






{% endblock scripts %}