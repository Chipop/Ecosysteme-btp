{% extends "SocialMedia/base_socialmedia.html" %}
{% load staticfiles %}
{% load nbsp %}
{% load widget_tweaks %}
{% block title %}ESPR ReseauSocial{% endblock %}



{% block scripts %}
    {{ block.super }}


    {% include 'SocialMedia/statuts/modals/likers_modal.html' %}
    {% include 'SocialMedia/statuts/modals/modifier_statut_modal.html' %}
    {% include 'SocialMedia/statuts/modals/signaler_statut_modal.html' %}
    {% include 'SocialMedia/statuts/modals/modifier_commentaire_modal.html' %}
    {% include 'SocialMedia/statuts/modals/signaler_commentaire_modal.html' %}
    {% include 'SocialMedia/statuts/modals/share_statut_modal.html' %}

    <script>
        let addStatutURL = "{% url 'SocialMedia:add_statut' id=request.user.profil.id type_statut='profil' %}";
        let add_comment_url = "{% url 'SocialMedia:st_add_comment' %}";
        let spinner = '<img src="{% static "SocialMedia/img/YX5xG_s-200x150.gif" %}" width=30 height=30 />';
        let url_like = "{% url 'SocialMedia:statut_like' %}";
        let url_like_comment = '{% url 'SocialMedia:comment_like' %}';
        let add_comment_reply_url = '{% url 'SocialMedia:st_add_comment_reply' %}';
        let st_get_likers_url = '{% url 'SocialMedia:statut_get_likers' %}';
        let comment_get_likers_url = '{% url 'SocialMedia:comment_get_likers' %}';
        let st_get_more_comments_url = '{% url 'SocialMedia:st_get_more_comments' %}';
        let st_update_content_url = '{% url 'SocialMedia:st_update_content' %}';
        let st_delete_url = '{% url 'SocialMedia:st_delete' %}';
        let st_signal_url = '{% url 'SocialMedia:st_signal' %}';
        let comment_update_content_url = '{% url 'SocialMedia:comment_update_content' %}';
        let comment_delete_url = '{% url 'SocialMedia:comment_delete' %}';
        let comment_signal_url = '{% url 'SocialMedia:comment_signal' %}';
        let st_share_url = '{% url 'SocialMedia:st_share' %}';
        let st_check_link_url = '{% url 'SocialMedia:st_link_preview' %}';

        let loaded = [];

    </script>

    <script src="{% static 'SocialMedia/js/statuts/statuts.js' %}"></script>

    <script>
        initialize_infinite_scrol();

        {% for st in statuts %}
            loaded.push({{ st.id }});
        {% endfor %}

    </script>


{% endblock %}


{% block content %}

    <!-- Wrapper Start -->
    <div class="wrapper">

        <!-- Page Wrapper Start -->
        <section class="page--wrapper pt--80 pb--20" style="transform: none;padding-top: 20px;">
            <div class="container">
                <div class="row">


                    <!-- Main Sidebar Start -->
                    <div class="main--sidebar col-md-3 pb--60" data-trigger="stickyScroll">
                        <!-- Widget Start -->
                        <div class="widget" style="    padding: 10px 20px;    background-color: white;">
                            <div class="row">
                                <a href="/reseausocial/profil/">
                                    <div class="col-xs-12 text-center">
                                        <img src="{{ user.profil.photo_profil.image.url }}"
                                             class="img-circle" style="width:100px; height: 100px;"
                                             alt="">
                                    </div>

                                    <div class="col-xs-12 text-center">
                                        <h4>{{ user.first_name | title }} {{ user.last_name |title }}</h4>
                                    </div>
                                </a>
                            </div>
                            <!-- Groupes End -->
                        </div>
                        <!-- Widget End -->

                        <!-- Relations Start -->
                        <div class="widget" style="     padding: 10px 20px;   background-color: white;">


                            <!-- Text Widget Start -->
                            <div class="text--widget text-center">
                                <p class="h4 badge"
                                   style="font-weight: 500;font-size: 20px;padding: 5px;color: white;">{{ amis }}</p>
                                <p style="color:grey;font-size: 16px; font-weight: 500;">Relations</p>
                                <div id="statuts" class=" ivm-view-attr__img-wrapper--expanded ember-view">
                                    <!---->
                                    <a style="color: #ea4b0f;" href="{% url 'SocialMedia:Amis' %}"><span class="ml--15">Tout voir</span></a>
                                    <!---->
                                </div>
                                <a href="{% url 'SocialMedia:Amis' %}">
                                    <div id="statuts" class="mn-connections-summary__social-proof ember-view">
                                        <div class="mn-social-proof">
                                            <div class="mn-social-proof__facepiles">
                                                {% for f in friends|slice:"4" %}
                                                    {% if not forloop.first %}
                                                        <img style="margin-left: -20px;"
                                                             class="lazy-image loaded mn-social-proof__profile-image EntityPhoto-circle-2"
                                                             alt="{{ f.nom }}" height="40" width="40"
                                                             src="{{ f.photo_profil.image.url }}">
                                                    {% else %}
                                                        <img class="lazy-image mn-social-proof__profile-image EntityPhoto-circle-2 loaded"
                                                             alt="{{ f.nom }}" height="40" width="40"
                                                             src="{{ f.photo_profil.image.url }}">
                                                    {% endif %}
                                                {% endfor %}
                                                <!---->  </div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <!-- Text Widget End -->
                        </div>

                        <div class="widget" style="    padding: 10px 20px;    background-color: white;">


                            <!-- Text Widget Start -->
                            <div class="text--widget text-center">
                                <div id="statuts" class=" ivm-view-attr__img-wrapper--expanded ember-view">
                                    <!---->
                                    <a style="color: #ea4b0f;" href="{% url 'SocialMedia:reseau' %}"><span
                                            class="ml--15">Trouver des relations</span></a><!---->
                                </div>
                            </div>
                            <!-- Text Widget End -->
                        </div>
                        <!-- Main Sidebar End -->

                        <!-- Main Content Start -->

                    </div>


                    <!-- Activity List Start -->


                    <div class="main--sidebar col-md-6 pb--60">

                        {% block main_content %}
                            <div class="row" style="    max-width:  100%;    margin-left: auto;    margin-right: auto;">
                                <div class="">
                                    {% if request.user.is_authenticated %}
                                        <div class="row"
                                             style="    max-width:  100%;    margin-left: auto;    margin-right: auto;">
                                            <div class="well well-sm well-social-post">

                                                    <form onsubmit="add_statut(event, this)" novalidate=""
                                                      enctype="multipart/form-data">

                                                    <p style="width: 100%;">
                                                        <button onclick="displayStatut(this)" class="btstatutHIDESHOW"
                                                                type="button"
                                                                style="font-size: 16px; text-align: -webkit-left; font-weight: 400; width: 100%; padding: 10px; border: none; background-color: transparent; box-sizing: border-box; font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, &quot;Fira Sans&quot;, Ubuntu, Oxygen, &quot;Oxygen Sans&quot;, Cantarell, &quot;Droid Sans&quot;, &quot;Lucida Grande&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;">
                                                            Partagez une photo, un article, une vidéo ou une idée
                                                        </button>
                                                    </p>

                                                    {% render_field form.contenu_statut onblur="hideStatut(this)" class="form-control" placeholder="Écrivez ici vos statuts." id="statut" style="display:none;" %}

                                                    <input type="hidden" name="st_input_link_link"
                                                           id="st_input_link_link">
                                                    <input type="hidden" name="st_input_link_description"
                                                           id="st_input_link_description">
                                                    <input type="hidden" name="st_input_link_title"
                                                           id="st_input_link_title">
                                                    <input type="hidden" name="st_input_link_icon"
                                                           id="st_input_link_icon">

                                                    <div id="st_link_preview_loading" class="st_link_preview">
                                                        <div class="display-flex">
                                                            <div class="flex-2">
                                                                <img src="{% static 'SocialMedia/img/infinite_preloading.gif' %}"
                                                                     alt="">
                                                            </div>
                                                            <div class="flex-8 st_link_preview_content">
                                                                <p>Chargement de l'aperçu du lien en cours...</p>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div id="st_link_preview_error" class="st_link_preview">
                                                        <div class="display-flex">
                                                            <div class="text-center flex-2">
                                                                <i class="st_link_preview_info_icon fa fa-info-circle"></i>
                                                            </div>
                                                            <div class="flex-8 st_link_preview_content">
                                                                <p>Chargement de laperçu du lien impossible</p>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div id="st_link_preview_details" class="st_link_preview"
                                                         data-displayed="false"
                                                         data-enabled="true">
                                                        <div style="display:flex;">
                                                            <a class="st_link_preview_href" href="#">
                                                                <div class="flex-2">
                                                                    <img id="st_link_preview_image"
                                                                         src="{% static 'SocialMedia/img/businessman.jpg' %}"
                                                                         alt="">
                                                                </div>
                                                            </a>

                                                            <a class="st_link_preview_href st_link_preview_href_content"
                                                               href="#">
                                                                <div class="flex-2 st_link_preview_content_result">

                                                                    <h3 id="st_preview_link_title"></h3>
                                                                    <p id="st_preview_link_description"></p>
                                                                </div>
                                                            </a>

                                                            <div onclick="remove_link_preview_displayed();"
                                                                 id="st_link_preview_close_link"
                                                                 class="st_link_preview_close_div">
                                                                <i class="st_link_preview_close_icon fa fa-times-rectangle"></i>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="st_publier_media">

                                                        <div data-enabled="false"
                                                             class="col-lg-12 st_videos  st_publier_videos clear-both"
                                                             style="display:none;">

                                                            <div onclick="st_publier_fichiers_close(this,$('#st_input_upload_video'));"
                                                                 id="st_publier_fichiers_remove"
                                                                 class="st_link_preview_close_div">
                                                                <i class="st_link_preview_close_icon fa fa-times-rectangle"></i>
                                                            </div>

                                                            <div id="st_publier_video"
                                                                 class="st_uploading_file_container"
                                                                 style="    margin-top: 34px;">

                                                            </div>

                                                        </div>

                                                        <div class="col-lg-12 " data-enabled="false"
                                                             style="display:none;">

                                                            <div onclick="st_publier_fichiers_close(this,$('#st_input_upload_images'));"
                                                                 id="st_publier_fichiers_remove"
                                                                 class="st_link_preview_close_div">
                                                                <i class="st_link_preview_close_icon fa fa-times-rectangle"></i>
                                                            </div>

                                                            <div id="st_publier_images" style="    margin-top: 34px;">

                                                            </div>

                                                        </div>

                                                        <div class="col-lg-12 " style="display:none;"
                                                             data-enabled="false">
                                                            <div onclick="st_publier_fichiers_close(this,$('#st_input_upload_files'));"
                                                                 id="st_publier_fichiers_remove"
                                                                 class="st_link_preview_close_div">
                                                                <i class="st_link_preview_close_icon fa fa-times-rectangle"></i>
                                                            </div>
                                                            <div id="st_publier_fichiers" style="    margin-top: 34px;">

                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div style="clear:both;">

                                                    </div>


                                                    <ul class="list-inline post-actions"
                                                        style="    font-size: 18px;          padding: 13px 22px;">

                                                        <li>
                                                            <label>
                                                                <i id="st_upload_image_icon" class="fa fa-camera"></i>
                                                                {% render_field form.image id="st_input_upload_images" id="IMGST" style="display: none;max-height: 400px;" %}
                                                                </i>
                                                            </label>
                                                        </li>

                                                        <li>
                                                            <label>
                                                                <i id="st_upload_video_icon" class=" fa fa-video-camera"
                                                                   aria-hidden="true">
                                                                    {% render_field form.video id="st_input_upload_video" style="display: none;" %}
                                                                </i>
                                                            </label>
                                                        </li>

                                                        <li>
                                                            <label>
                                                                <i id="st_upload_file_icon" class=" fa fa-paperclip "
                                                                   aria-hidden="true">

                                                                    {% render_field form.document id="st_input_upload_files" style="display: none;" %}
                                                                </i>
                                                            </label>
                                                        </li>

                                                        <li class="pull-right">
                                                            <button id="st_btn_add_statut"
                                                                    class=" btn btn-primary btn_status "
                                                                    type="submit"
                                                                    style="margin-top:0px;display: inline-block;">
                                                                Publier
                                                            </button>

                                                        </li>
                                                    </ul>
                                                </form>
                                            </div>
                                        </div>

                                    {% endif %}

                                    <div class="row">
                                        <div id="filActualite" class="main--sidebar col-md-6 pb--60"
                                             style="    width: 100%;">

                                            <div class="activity--list">

                                                <!-- Activity Items Start -->

                                                <div id="likers">
                                                </div>

                                                <ul class="activity--items nav  infinite-container">


                                                    {% for statut in statuts %}

                                                        {% include "SocialMedia/statuts/shared_and_original_statuts.html" %}

                                                    {% endfor %}

                                                </ul>

                                                <div id="loadingImageMoreComments" class="row text-center"
                                                     style="display:none;">
                                                    <img height="64" width="64" class="img-rounded"
                                                         src="{% static 'SocialMedia/Spinner.gif' %}"/>
                                                </div>

                                            </div>
                                            <!-- Activity List End -->


                                            <!-- Load More Button Start -->
                                            {% if statuts.has_next %}
                                                <div class="load-more--btn pt--30 text-center hidden">
                                                    <a href="?page={{ statuts.next_page_number }}"
                                                       class="btn btn-animate infinite-more-link">
                                                        <span><i class="fa ml--10 fa-caret-right"></i></span>
                                                    </a>
                                                </div>
                                            {% endif %}
                                            <!-- Load More Button End -->


                                        </div>

                                    </div>

                                </div>
                            </div>


                            <!-- Activity List End -->


                            <!-- Load More Button Start -->
                            {% if statuts.has_next %}
                                <div class="load-more--btn pt--30 text-center hidden">
                                    <a href="?page={{ statuts.next_page_number }}"
                                       class="btn btn-animate infinite-more-link">
                                        <span><i class="fa ml--10 fa-caret-right"></i></span>
                                    </a>
                                </div>
                            {% endif %}
                            <!-- Load More Button End -->

                        {% endblock main_content %}

                    </div>

                    <div class="main--sidebar col-md-3 " data-trigger="stickyScroll">


                        <!-- Widget Start -->
                        <div class="widget" style="padding: 0px 5px;overflow-x: hidden;">
                            <div class="row">
                                <div class="list-group" style="margin-bottom: 0px;">
                                    <a href="{% url 'SocialMedia:creer_entreprise' %}"
                                       class="list-group-item list-group-item-action">
                                        <div style=" font-family: -apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Fira Sans,Ubuntu,Oxygen,Oxygen Sans,Cantarell,Droid Sans,Apple Color Emoji,Segoe UI Emoji,Segoe UI Emoji,Segoe UI Symbol,Lucida Grande,Helvetica,Arial,sans-serif; font-size: 14px; font-weight: 600; text-align: center; "
                                             id="statuts" class="Sans-17px-black-85%-semibold ph5 pv4">
                                            Créer une page Entreprise <span
                                                style=" position: relative; top: 3px; left: 4px; margin: 0 8px; "
                                                class="nav-business-services__svg-icon nav-business-services__svg-icon--nearby svg-icon-wrap"><li-icon
                                                aria-hidden="true" type="plus-icon" size="small"><svg
                                                viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0"
                                                preserveAspectRatio="xMinYMin meet" class="artdeco-icon"
                                                focusable="false"><path d="M14,9H9v5H7V9H2V7H7V2H9V7h5V9Z"
                                                                        class="small-icon"
                                                                        style="fill-opacity: 1"></path></svg></li-icon></span>
                                        </div>
                                    </a>
                                    <a href="{% url 'SocialMedia:creer_groupe' %}"
                                       class="list-group-item list-group-item-action">
                                        <div style=" font-family: -apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Fira Sans,Ubuntu,Oxygen,Oxygen Sans,Cantarell,Droid Sans,Apple Color Emoji,Segoe UI Emoji,Segoe UI Emoji,Segoe UI Symbol,Lucida Grande,Helvetica,Arial,sans-serif; font-size: 14px; font-weight: 600; text-align: center; "
                                             id="statuts" class="Sans-17px-black-85%-semibold ph5 pv4">
                                            Créer un Groupe <span
                                                style=" position: relative; top: 3px; left: 4px; margin: 0 8px; "
                                                class="nav-business-services__svg-icon nav-business-services__svg-icon--nearby svg-icon-wrap"><li-icon
                                                aria-hidden="true" type="plus-icon" size="small"><svg
                                                viewBox="0 0 24 24" width="24px" height="24px" x="0" y="0"
                                                preserveAspectRatio="xMinYMin meet" class="artdeco-icon"
                                                focusable="false"><path d="M14,9H9v5H7V9H2V7H7V2H9V7h5V9Z"
                                                                        class="small-icon"
                                                                        style="fill-opacity: 1"></path></svg></li-icon></span>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- Widget End -->

                        <div id="statuts" class="side-panel__overlay global-alert-offset ember-view">
                            <div id="ember2265" class="ember-view">


                                <div id="ember2266" class="ember-view">
                                    <div class="nav-app-launcher__card"
                                         style=" border: 1px solid rgba(0,0,0,.15);  padding-bottom: 0; background-color: #fff; ">


                                        <div class="Sans-17px-black-85%-semibold ph5 pv4" style="padding-bottom: 10px;">
                                            Entreprises
                                        </div>

                                        <div class="divider mt0 mb2"></div>


                                        <ul class="nav-app-launcher__app-icon-list pv2 list-style-none"
                                            style="padding-left: 20px;background-color: white;height: 100%;max-height: 266px;overflow-y: scroll;overflow-x: hidden;">
                                            {% if entreprises.count != 0 %}
                                                {% for ent in entreprises %}
                                                    <li class="nav-app-launcher__app-icon-item nav-app-launcher__app-icon-item--narrow"
                                                        style="display: inline-block; width: 100px; text-align: center; margin-bottom: 8px; padding-top: 4px; vertical-align: top;">
                                                        <a data-control-name="nav.launcher_learning" target="_blank"
                                                           href="{% url 'SocialMedia:page_entreprise' ent.id %}"
                                                           id="ember2267"
                                                           class="nav-app-launcher__app-icon-link block pt1 ember-view">          <span
                                                                class="nav-app-launcher__svg-icon svg-icon-wrap"><li-icon
                                                                style=" border-radius: 4px; box-shadow: 0 0 4px rgba(0,0,0,0.85); "
                                                                aria-hidden="true" type="app-learning-icon">

                                                            <img style="height: 100%;" src="{{ ent.entreprise.logo.url }}" viewBox="0 0 40 40" width="40px" height="40px" x="0"
                                                                 y="0" preserveAspectRatio="xMinYMin meet" focusable="false"/>
                                                        </li-icon></span>
                                                            <h5 title="LinkedIn Learning"
                                                                class="break-words Sans-13px-black-55%">{{ ent.entreprise.nom }}</h5>
                                                        </a></li>
                                                {% endfor %}
                                            {% else %}

                                                <header id="status" class="artdeco-card__header text-center">
                                                    <h3 class="artdeco-card__title"
                                                        style="    padding: 13px 16px 16px 16px;margin-top: 0;font-size: 20px;line-height: 28px;    font-weight: 400;">
                                                        Aucune Entreprise n'a été trouvée.
                                                    </h3>
                                                </header>
                                            {% endif %}
                                        </ul>
                                    </div>

                                </div>
                                </div>
                                </div>


                                <div id="ember2266" class="ember-view">
                                    <div class="nav-app-launcher__card"
                                         style=" border: 1px solid rgba(0,0,0,.15);  padding-bottom: 0; background-color: #fff; ">


                                        <div class="Sans-17px-black-85%-semibold ph5 pv4" style="padding-bottom: 10px;">
                                            Groupes
                                        </div>

                                        <div class="divider mt0 mb2"></div>


                                        <ul class="nav-app-launcher__app-icon-list pv2 list-style-none"
                                            style="padding-left: 20px;background-color: white;height: 100%;max-height: 266px;overflow-y: scroll;overflow-x: hidden;">
                                            {% if grs.count != 0 %}
                                                {% for g in grs %}
                                                    <li class="nav-app-launcher__app-icon-item nav-app-launcher__app-icon-item--narrow"
                                                        style="display: inline-block; width: 100px; text-align: center; margin-bottom: 8px; padding-top: 4px; vertical-align: top;">
                                                        <a data-control-name="nav.launcher_learning" target="_blank"
                                                           href="{% url 'SocialMedia:groupe' g.id %}" id="ember2267"
                                                           class="nav-app-launcher__app-icon-link block pt1 ember-view">          <span
                                                                class="nav-app-launcher__svg-icon svg-icon-wrap"><li-icon
                                                                style=" border-radius: 4px; box-shadow: 0 0 4px rgba(0,0,0,0.85); "
                                                                aria-hidden="true" type="app-learning-icon">

    <img style="height: 100%;" src="{{ g.photo_profil.image.url }}" viewBox="0 0 40 40" width="40px" height="40px" x="0"
         y="0" preserveAspectRatio="xMinYMin meet" focusable="false"/>
</li-icon></span>
                                                            <h5 title="LinkedIn Learning"
                                                                class="break-words Sans-13px-black-55%">{{ g.nom }}</h5>
                                                        </a></li>
                                                {% endfor %}
                                            {% else %}

                                                <header id="status" class="artdeco-card__header text-center">
                                                    <h3 class="artdeco-card__title"
                                                        style="    padding: 13px 16px 16px 16px;margin-top: 0;font-size: 20px;line-height: 28px;    font-weight: 400;">
                                                        Aucun Groupe n'a été trouvé.
                                                    </h3>
                                                </header>
                                            {% endif %}
                                        </ul>
                                    </div>

                                </div>


                    </div>

                </div>


            </div>
        </section>
        <!-- Page Wrapper End -->
    </div>

{% endblock content %}

